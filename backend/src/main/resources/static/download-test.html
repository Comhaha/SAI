<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ë‹¤ìš´ë¡œë“œ í…ŒìŠ¤íŠ¸</title>
  <style>
    body { font-family: sans-serif; max-width: 600px; margin: 40px auto; }
    label { display:block; margin: 12px 0 4px; }
    input { width: 100%; padding: 8px; }
    button { margin-top: 16px; padding: 10px 16px; }
    #log { margin-top: 24px; white-space: pre-wrap; font-size: 0.9rem; color:#555; }
  </style>
</head>
<body>
<h2>ğŸ“¥ S3 íŒŒì¼ ë‹¤ìš´ë¡œë“œ í…ŒìŠ¤íŠ¸</h2>

<label>Bucket</label>
<input id="bucket" placeholder="ex) my-bucket" />

<label>Object Key</label>
<input id="key" placeholder="ex) path/to/report.pdf" />

<button id="btn">Download</button>

<div id="log"></div>

<script type="module">
  const btn    = document.getElementById('btn');
  const logBox = document.getElementById('log');

  function log(msg){ logBox.textContent = msg; }

  btn.addEventListener('click', async () => {
    const bucket = document.getElementById('bucket').value.trim();
    const key    = document.getElementById('key').value.trim();
    if(!bucket || !key){ return alert('Bucket ê³¼ Object Key ë¥¼ ì…ë ¥í•˜ì„¸ìš”.'); }

    const apiUrl = `/api/download`;
    log(`â³ ìš”ì²­:  ${apiUrl}`);

    try{
      const res  = await fetch(apiUrl);
      const json = await res.json();
      const url  = json.result;

      log(`âœ… presigned URL ìˆ˜ì‹  ì™„ë£Œ â†’ ë¸Œë¼ìš°ì € ì´ë™`);
      window.location.href = url;          // ì‹¤ì œ ë‹¤ìš´ë¡œë“œ ì‹¤í–‰
    }catch(e){
      console.error(e);
      log(`âŒ ì˜¤ë¥˜: ${e.message}`);
      alert('ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨');
    }
  });
</script>
</body>
</html>
